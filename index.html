<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Detecting Environmental Outliers in Biogeographical Modeling Workflows â€¢ specleanr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Detecting Environmental Outliers in Biogeographical Modeling Workflows">
<meta name="description" content="A framework used to detect and remove environmental outliers in species distribution models across taxa and environmental predictors. Also, data retrieval and preprocessing, model fitting to enable performance comparisions are allowed.">
<meta property="og:description" content="A framework used to detect and remove environmental outliers in species distribution models across taxa and environmental predictors. Also, data retrieval and preprocessing, model fitting to enable performance comparisions are allowed.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">specleanr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/eOutlier.html">Environmental outlier detection with bootstrapping and principal component analysis.</a></li>
    <li><a class="dropdown-item" href="articles/generaloutlier.html">General outlier detection for univariate datasets</a></li>
    <li><a class="dropdown-item" href="articles/Plants.html">Detecting environmental outliers in species distribution models for plants.</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AnthonyBasooma/specleanr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="specleanr-package-for-outlier-detection">specleanr package for outlier detection<a class="anchor" aria-label="anchor" href="#specleanr-package-for-outlier-detection"></a>
</h1></div>
<!-- README.md is generated from README.Rmd. Please edit that file -->
<!-- badges: start -->

<!-- badges: end -->
<p><img src="reference/figures/specleanlogo.png" align="right" alt="logo" width="150" height="190"></p>
<p><code>specleanr</code> The package aims to improve the reliability and acceptability of biogeographical models, including species distribution models, ecological niche models, and bioclimatic envelope models, by detecting outliers in the environmental predictors. In the package, we collate <strong>20 outlier detection methods</strong>, which a user can collectively apply (ensemble outlier detection) and determine whether the species records are in a suitable environmental space. The package complements other packages that address geographical, taxonomic, and temporal checks.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span></span>
<span><span class="co">#remotes::install_github("AnthonyBasooma/specleanr")</span></span></code></pre></div>
<div class="section level3">
<h3 id="process-of-identifying-environmental-outliers">Process of identifying environmental outliers.<a class="anchor" aria-label="anchor" href="#process-of-identifying-environmental-outliers"></a>
</h3>
<p>The process of identifying environmental outliers is generally classified into <strong>five steps</strong> as detailed below (Figure 1);</p>
<figure><img src="reference/figures/Figure1.png" alt="Figure 1. Workflow for processing species occurrence data within the specleanr R-package for environmental outlier detection, removal, and evaluation."><figcaption aria-hidden="true">
Figure 1. Workflow for processing species occurrence data within the specleanr R-package for environmental outlier detection, removal, and evaluation.
</figcaption></figure><!--(![This is the caption!](img/rmarkdown_hex.png))--><ol style="list-style-type: decimal">
<li>
<strong>Arranging of species records and environmental data</strong>.</li>
</ol>
<p>This includes collecting species data from either online sources or locally stored data. The user can check for species records for geographical, taxonomic, or temporal inconsistencies such as missing coordinates, interchanged coordinates, species name spelling mistakes, and wrong event dates. Environmental data, mainly in the raster format, is based chiefly on user needs, but numerous sources include WORLDCLIM (Fick &amp; Hijmans, 2017) and CHELSA (Karger et al., 2017) for bioclimatic variables; Hydrography90m for stream or river-based hydromorphological parameters such as stream order, flow accumulation, stream power index, and stream transportation index (Amatulli et al., 2022); and Copernicus for land use changes <a href="https://www.copernicus.eu/en" class="external-link uri">https://www.copernicus.eu/en</a>.</p>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Extracting the environmental predictors</strong>.</li>
</ol>
<p>The environmental predictors are extracted from points where the species was recorded present or absent. The extracted dataset forms the species <strong>reference dataset</strong> for environmental outlier checks. In the package we included <strong><code><a href="reference/pred_extract.html">pred_extract()</a></code></strong> to extract the environmental predictors.</p>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Ensemble multiple methods for outlier detection</strong>.</li>
</ol>
<p>Multiple outlier detection methods are used; each method flags outliers in the same dataset. These outliers are then compared among methods to determine records, which are flagged by several methods called <strong>absolute outliers</strong> or <strong>true outliers</strong>. The total number of methods that a user can ensemble is user-based; however, we expect the user to set at least <strong>three</strong> outlier detection methods. The methods should be also at least from different categories, which include <strong>1) univariate methods</strong>, <strong>2) multivariate methods</strong>, and <strong>3) ecological ranges</strong>. The must set all the methods using <strong><code><a href="reference/multidetect.html">multidetect()</a></code></strong> function and not individual method functions to allow seamless comparison.</p>
<p><strong>Univariate methods</strong></p>
<p>These methods only detect outliers in one environmental predictor. It is strongly advisable that the user selects an environmental predictor which directly affects the species distribution, for example, minimum temperature of the coldest month (IUCN 2012; Logez et al., 2012).</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="43%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Method implemented</th>
<th align="right">Userword in <strong><code><a href="reference/multidetect.html">multidetect()</a></code></strong>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="reference/zscore.html">zscore()</a></code></td>
<td align="left">Z-score</td>
<td align="right">zscore</td>
</tr>
<tr class="even">
<td align="left"><code><a href="reference/semiIQR.html">semiIQR()</a></code></td>
<td align="left">Semi interquartile range</td>
<td align="right">semiqr</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="reference/adjustboxplots.html">adjustboxplots()</a></code></td>
<td align="left">Adjusted boxplot-robust boxplot method</td>
<td align="right">adjbox</td>
</tr>
<tr class="even">
<td align="left"><code><a href="reference/interquartile.html">interquartile()</a></code></td>
<td align="left">Interquartile range (IQR)</td>
<td align="right">iqr</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="reference/medianrule.html">medianrule()</a></code></td>
<td align="left">Median rule method</td>
<td align="right">medianrule</td>
</tr>
<tr class="even">
<td align="left"><code><a href="reference/logboxplot.html">logboxplot()</a></code></td>
<td align="left">Logarithmic boxplot</td>
<td align="right">logboxplot</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="reference/seqfences.html">seqfences()</a></code></td>
<td align="left">Sequential fences</td>
<td align="right">seqfences</td>
</tr>
<tr class="even">
<td align="left"><code><a href="reference/mixediqr.html">mixediqr()</a></code></td>
<td align="left">Mixed semi and interquartile range</td>
<td align="right">mixediqr</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="reference/distboxplot.html">distboxplot()</a></code></td>
<td align="left">distribution-based boxplots</td>
<td align="right">distboxplot</td>
</tr>
<tr class="even">
<td align="left"><code>rjknife()</code></td>
<td align="left">Reverse jackknifing</td>
<td align="right">jknife</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="reference/hampel.html">hampel()</a></code></td>
<td align="left">The Hampel filter method</td>
<td align="right">hampel</td>
</tr>
</tbody>
</table>
<p><strong>Multivariate methods</strong></p>
<p>These methods detect outliers in multiple environmental predictors (multidimensional space). User should exclude unnecessary columns such as the coordinates such that they are not included in the computation.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="48%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">Function</th>
<th align="left">Method used to fit and detect outliers</th>
<th align="right">Userword in <strong><code><a href="reference/multidetect.html">multidetect()</a></code></strong>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="reference/isoforest.html">isoforest()</a></code></td>
<td align="left">Isolation forest</td>
<td align="right">iforest</td>
</tr>
<tr class="even">
<td align="left"><code><a href="reference/onesvm.html">onesvm()</a></code></td>
<td align="left">One-class support vector machine</td>
<td align="right">onvesvm</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="reference/xglosh.html">xglosh()</a></code></td>
<td align="left">Global-Local Outlier Score from Hierarchies.</td>
<td align="right">glosh</td>
</tr>
<tr class="even">
<td align="left"><code><a href="reference/xknn.html">xknn()</a></code></td>
<td align="left">k-nearest neighbor</td>
<td align="right">knn</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="reference/xlof.html">xlof()</a></code></td>
<td align="left">Local outlier factor</td>
<td align="right">lof</td>
</tr>
<tr class="even">
<td align="left"><code><a href="reference/xkmeans.html">xkmeans()</a></code></td>
<td align="left">k-means clustering</td>
<td align="right">kmeans</td>
</tr>
<tr class="odd">
<td align="left"><code>xkmedoids()</code></td>
<td align="left">Partitioning around the kmedoids</td>
<td align="right">kmedoid</td>
</tr>
<tr class="even">
<td align="left"><code><a href="reference/mahal.html">mahal()</a></code></td>
<td align="left">Mahalanobis distances both robust and simple</td>
<td align="right">mahal</td>
</tr>
</tbody>
</table>
<p><strong>Ecological ranges</strong></p>
<p>The user collates the species optimal ecological ranges to identify the species records outside the known optimal ranges. In the package, for a single species, the optimal ranges (minimum, maximum, or mean values) are provided manually, and the user is required to set the environmental predictor to be used for flagging the outliers. A dataset with the minimum and maximum values (optimal ranges) is allowed for multiple species. <strong>Note</strong> If the taxa is fish, we included the <strong><code><a href="reference/thermal_ranges.html">thermal_ranges()</a></code></strong> and <strong><code><a href="reference/geo_ranges.html">geo_ranges()</a></code></strong> functions, which a user can set to flag records exceeding the FishBase collated temperature and latitudinal/longitudinal ranges. The user word <strong>optimal</strong> <strong><code>must</code></strong> be used in the <strong><code><a href="reference/multidetect.html">multidetect()</a></code></strong> function for seamless comparisons with other methods.</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Extract species environmental without outliers</strong></li>
</ol>
<p><strong>Threshold identification</strong></p>
<p>After outlier removal, the threshold to classify a record as an absolute outlier that necessitates the user to do so objectively is pivotal in this workflow. Therefore, we have developed three options for obtaining a threshold. A threshold is the proportion of methods that flagged a record as an outlier to the total number of techniques used. For example, if a user includes ten methods and sets a threshold of 0.7, it implies that an absolute outlier will be flagged in at least seven methods. In this package, we developed three ways to identify the optimal threshold.</p>
<ul>
<li><p><strong>Naive method</strong>: where the user sets a value between 0.1 and 1. The process is subjective, but using this method, it is advisable to use a threshold beyond 0.6 to highlight records flagged in at least 50% of the methods.</p></li>
<li><p><strong>loess method</strong>: we apply local regression (locally estimated/weighted scatterplot smoothing) to identify the optimal threshold, a non-parametric smoothing method that uses local variability in the data (Cleveland &amp; Loader, 1996; Loader, 2004).</p></li>
</ul>
<p>The <strong>reference dataset</strong> in <strong>Step 2</strong> and lists or outliers flagged by each method in <strong>Step 3</strong> are then used to retain the <strong>clean dataset</strong>. Under the hood, two approaches are implemented <strong>1) absolute method</strong>: where absolute outliers are removed at a particular threshold or <strong>2) suitable or best outlier detection method</strong> where a method with highest proportion of absolute outliers and has highest similarity with other methods (in terms of the outliers flagged) can be used.</p>
<ul>
<li>
<code><a href="reference/extract_clean_data.html">extract_clean_data()</a></code> to extract clean data using the reference data and outliers for single species.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><strong>Post-environmental outlier removal</strong></li>
</ol>
<ul>
<li>
<code><a href="reference/ggoutliers.html">ggoutliers()</a></code> to visualize the outliers flagged by each method. If multiple species are considered, then the index or species name should be provided.
<p>
After environmental outlier removal, the user can examine the improvement in the model performance before and after environmental outlier removal. The following function can be used.
</p>
</li>
</ul>
<p><strong>Package website</strong> To access the details of this package, please check it website on <a href="https://AnthonyBasooma.github.io/specleanr/" class="external-link">specleanr</a></p>
</div>
<div class="section level3">
<h3 id="package-citation">Package citation<a class="anchor" aria-label="anchor" href="#package-citation"></a>
</h3>
<p>Under review</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Amatulli, G., Garcia Marquez, J., Sethi, T., Kiesel, J., Grigoropoulou, A., Ãœblacker, M. M., Shen, L. Q., &amp; Domisch, S. (2022). Hydrography90m: A new high-resolution global hydrographic dataset. Earth System Science Data, 14(10), 4525â€“4550. <a href="https://doi.org/10.5194/essd-14-4525-2022" class="external-link uri">https://doi.org/10.5194/essd-14-4525-2022</a></p></li>
<li><p>Cleveland, W. S., &amp; Loader, C. (1996). Smoothing by local regression: Principles and methods. In Statistical Theory and Computational Aspects of Smoothing: Proceedings of the COMPSTATâ€™94 Satellite Meeting Held in Semmering, Austria, 27-28, 10â€“49.</p></li>
<li><p>Fick, S. E., &amp; Hijmans, R. J. (2017). WorldClim 2: new 1-km spatial resolution climate surfaces for global land areas. International Journal of Climatology, 37(12), 4302â€“4315. <a href="https://doi.org/10.1002/joc.5086" class="external-link uri">https://doi.org/10.1002/joc.5086</a></p></li>
<li><p>Karger, D. N., Conrad, O., BÃ¶hner, J., Kawohl, T., Kreft, H., Soria-Auza, R. W., Zimmermann, N. E., Linder, H. P., &amp; Kessler, M. (2017). Climatologies at high resolution for the earthâ€™s land surface areas. Scientific Data, 4. <a href="https://doi.org/10.1038/sdata.2017.122" class="external-link uri">https://doi.org/10.1038/sdata.2017.122</a></p></li>
<li><p>Loader, C. (2004). Smoothing: local regression techniques. Handbook of Computational Statistics: Concepts and Methods, Art. 12.</p></li>
<li><p>Logez, M., Belliard, J., Melcher, A., Kremser, H., Pletterbauer, F., Schmutz, S., Gorges, G., Delaigue, O., &amp; Pont, D. (2012). Deliverable D5.1-3: BQEs sensitivity to global/climate change in European rivers: implications for reference conditions and pressure-impact-recovery chains.</p></li>
<li><p>IUCN Standards and Petitions Committee. (2022). THE IUCN RED LIST OF THREATENED SPECIESTM Guidelines for Using the IUCN Red List Categories and Criteria Prepared by the Standards and Petitions Committee of the IUCN Species Survival Commission. <a href="https://www.iucnredlist.org/documents/RedListGuidelines.pdf" class="external-link uri">https://www.iucnredlist.org/documents/RedListGuidelines.pdf</a>.</p></li>
</ol>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/AnthonyBasooma/specleanr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/AnthonyBasooma/specleanr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing specleanr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Anthony Basooma <br><small class="roles"> Author, maintainer </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="http://www.gnu.org/licenses/gpl-3.0.html" class="external-link"><img src="https://img.shields.io/badge/License-GPL%20%28%3E=%203%29-lightgrey.svg?style=flat" alt="License"></a></li>
<li><a href="https://github.com/AnthonyBasooma/specleanr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/AnthonyBasooma/specleanr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/AnthonyBasooma/specleanr" class="external-link"><img src="https://codecov.io/gh/AnthonyBasooma/specleanr/graph/badge.svg?token=M9431LXVLG" alt="codecov"></a></li>
<li><a href="https://github.com/AnthonyBasooma/specleanr/repo/releases" class="external-link"><img src="https://img.shields.io/github/downloads/AnthonyBasooma/specleanr/repo/total.svg" alt="GitHub Downloads"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anthony Basooma.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
