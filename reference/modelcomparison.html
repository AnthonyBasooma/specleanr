<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Comparing the model performance before and after outlier removal. — modelcomparison • specleanr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparing the model performance before and after outlier removal. — modelcomparison"><meta name="description" content="The function is used to compare model performance before and outlier removal.
The different thresholds are indicated and the model performance outputs are obtained
based on threshold dependent and independent metrics such as accuracy, sensitivity,
specificity, true skill statistics, and Area Under the Curve."><meta property="og:description" content="The function is used to compare model performance before and outlier removal.
The different thresholds are indicated and the model performance outputs are obtained
based on threshold dependent and independent metrics such as accuracy, sensitivity,
specificity, true skill statistics, and Area Under the Curve."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">specleanr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/eOutlier.html">Environmental outlier detection in fish species records.</a></li>
    <li><a class="dropdown-item" href="../articles/Plants.html">Detecting environmental outliers in species distribution models for plants.</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/removedxx/specleanr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comparing the model performance before and after outlier removal.</h1>
      <small class="dont-index">Source: <a href="https://github.com/removedxx/specleanr/blob/master/R/model_comp.R" class="external-link"><code>R/model_comp.R</code></a></small>
      <div class="d-none name"><code>modelcomparison.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function is used to compare model performance before and outlier removal.
The different thresholds are indicated and the model performance outputs are obtained
based on threshold dependent and independent metrics such as accuracy, sensitivity,
specificity, true skill statistics, and Area Under the Curve.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modelcomparison</span><span class="op">(</span></span>
<span>  <span class="va">refdata</span>,</span>
<span>  <span class="va">outliers</span>,</span>
<span>  <span class="va">raster</span>,</span>
<span>  models <span class="op">=</span> <span class="st">"GLM"</span>,</span>
<span>  metrics <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  thresholds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  loessthreshold <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  autothreshold <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"abs"</span>,</span>
<span>  colsp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboots <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  testprop <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  geom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prbackground <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  binary <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  full <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pabs <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  minpts <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-refdata">refdata<a class="anchor" aria-label="anchor" href="#arg-refdata"></a></dt>
<dd><p><code>list</code> or <code>dataframe</code> of species data generated during
pre-cleaning process. This data set is used as the reference data in
accessing the outlier detection performance using both threshold dependent
and independent metrics. This data set must be same as when in detecting
outliers to avoid mismatch.</p></dd>


<dt id="arg-outliers">outliers<a class="anchor" aria-label="anchor" href="#arg-outliers"></a></dt>
<dd><p><code>datacleaner</code> class data set with all outliers
obtained using the <code>multdetect</code> function.</p></dd>


<dt id="arg-raster">raster<a class="anchor" aria-label="anchor" href="#arg-raster"></a></dt>
<dd><p><code>SpatRaster</code>. The environmental where pseudo absences are extracted using
<code><a href="envextract.html">envextract</a></code> function.</p></dd>


<dt id="arg-models">models<a class="anchor" aria-label="anchor" href="#arg-models"></a></dt>
<dd><p><code>character</code>. The models to be used to examine the relationship between
species occurrences and environmental parameters. Only Random forest and
generalized linear models are accepted. <code>GLM</code> is used to set to
Generalized Linear Models and <code>RF</code> for Random Forest. <code>RF1</code>
variant is slower and is suggested if <code>RF</code> fails.</p></dd>


<dt id="arg-metrics">metrics<a class="anchor" aria-label="anchor" href="#arg-metrics"></a></dt>
<dd><p><code>character</code>. Either to only consider threshold-dependent <code>dep</code>,
threshold-independent <code>indep</code> or all evaluation metrics <code>all</code> to determine model
performance.</p></dd>


<dt id="arg-thresholds">thresholds<a class="anchor" aria-label="anchor" href="#arg-thresholds"></a></dt>
<dd><p><code>numeric</code>. The thresholds ranging from 0.1 to 1 but greater than 0.5 is advisable.</p></dd>


<dt id="arg-loessthreshold">loessthreshold<a class="anchor" aria-label="anchor" href="#arg-loessthreshold"></a></dt>
<dd><p>whether to consider loess or not.</p></dd>


<dt id="arg-autothreshold">autothreshold<a class="anchor" aria-label="anchor" href="#arg-autothreshold"></a></dt>
<dd><p><code>logical</code>. Identifies the threshold with mean number
of absolute outliers.The search is limited within 0.51 to 1 since
thresholds less than are deemed inappropriate for identifying absolute
outliers. The autothreshold is used when <code>threshold</code> is set to
<code>NULL</code>.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p><code>character</code> of either <code>abs</code> to use absolute outliers to
filter data or <code>best</code> to use the best method to filter the data
<code><a href="bestmethod.html">bestmethod</a></code> function.</p></dd>


<dt id="arg-colsp">colsp<a class="anchor" aria-label="anchor" href="#arg-colsp"></a></dt>
<dd><p><code>character</code>. Column with species names if the species occurrence is a
data frame not list,</p></dd>


<dt id="arg-nboots">nboots<a class="anchor" aria-label="anchor" href="#arg-nboots"></a></dt>
<dd><p><code>numeric</code> Creating sub samples for modeling evaluation. At least more than 5 is advisable.</p></dd>


<dt id="arg-testprop">testprop<a class="anchor" aria-label="anchor" href="#arg-testprop"></a></dt>
<dd><p><code>numeric</code>. The proportion to be used for partitioning data. Ranges from 0.1 to 1.
Less than 0.5 is advisable to allow have more model training data.</p></dd>


<dt id="arg-geom">geom<a class="anchor" aria-label="anchor" href="#arg-geom"></a></dt>
<dd><p><code>character</code>. Column name used to indicate geometry column during data extraction when the species
occurrences is of <code>sf</code> class and have geometry column instead of latitude
and longitude.</p></dd>


<dt id="arg-lat-lon">lat, lon<a class="anchor" aria-label="anchor" href="#arg-lat-lon"></a></dt>
<dd><p><code>character</code>. Column names for latitude/longitude if the species
occurrences don't have the geometry column or not spatial vector file.
The latitude and longitude must be
 provided for data extraction from the raster layers.</p></dd>


<dt id="arg-prbackground">prbackground<a class="anchor" aria-label="anchor" href="#arg-prbackground"></a></dt>
<dd><p><code>numeric</code>. Value indicating the proportion of pseudo
absences extracted in relation to the species presences. Used in <code>spatSample</code> function.
Ranges from at least 0.1 to 1. Check <code>(Barbet-Massin et al., 2012)</code> on the number of
pseudo absences required during species distribution modeling.</p></dd>


<dt id="arg-binary">binary<a class="anchor" aria-label="anchor" href="#arg-binary"></a></dt>
<dd><p><code>logical</code>. If <code>FALSE</code> the species dataset do not have
label column for presence absence and <code>label</code> is NULL.
If only species presences and absences  are indicated,
the user should select <code>TRUE</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p><code>logical</code>. Return messages or not. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p><code>logical</code>. Return warning or not. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-full">full<a class="anchor" aria-label="anchor" href="#arg-full"></a></dt>
<dd><p><code>logical</code>. Either full model output for <code>TRUE</code> or <code>FALSE</code> for only
performance metrics output.</p></dd>


<dt id="arg-pabs">pabs<a class="anchor" aria-label="anchor" href="#arg-pabs"></a></dt>
<dd><p><code>numeric</code>. Percentage of outliers allowed to be extracted from the data. If
<code>best</code> is used to extract outliers and the <code>pabs</code> is exceeded,
the absolute outliers are removed instead. This because some records  in
the best methods are repeated and they will likely to remove true values as
outliers.</p></dd>


<dt id="arg-minpts">minpts<a class="anchor" aria-label="anchor" href="#arg-minpts"></a></dt>
<dd><p><code>numeric</code> value indicating the minimum number of records required to run the species
distribution model. Default is <code>10</code>.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>true or false</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters can be used from <code><a href="envextract.html">envextract</a></code>
function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of model instance and model performance metrics.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Barbet-Massin, M., Jiguet, F., Albert, C. H., &amp; Thuiller, W. (2012).
Selecting pseudo-absences for species distribution models:
how, where and how many? Methods Ecol Evol 3: 327–338.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="sdmfit.html">sdmfit</a></code>, <code><a href="multidetect.html">multidetect</a></code>, <code><a href="pred_extract.html">pred_extract</a></code>, <code><a href="envextract.html">envextract</a></code>, <code><a href="boots.html">boots</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#worldclim data for to extract environmental predictors</span></span></span>
<span class="r-in"><span><span class="va">worldclim</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/worldclim.tiff'</span>, package<span class="op">=</span><span class="st">'specleanr'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#get 500 records online using getdata function to compliment salmo trutta records and basin polygon</span></span></span>
<span class="r-in"><span><span class="co">#basin to get the bounding box to delineate the area of concern</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/danube/basinfinal.shp'</span>, package<span class="op">=</span><span class="st">'specleanr'</span><span class="op">)</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">salmonline</span> <span class="op">&lt;-</span> <span class="fu"><a href="getdata.html">getdata</a></span><span class="op">(</span>data <span class="op">=</span> <span class="st">"Salmo trutta"</span>, gbiflim <span class="op">=</span> <span class="fl">500</span>, inatlim <span class="op">=</span> <span class="fl">3</span>, vertlim <span class="op">=</span> <span class="fl">3</span>, bbox <span class="op">=</span> <span class="va">db</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">salextract</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract_online.html">extract_online</a></span><span class="op">(</span><span class="va">salmonline</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#merge both online and offline data and filter Salmo trutta</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#select species with enough records</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">datafinal</span> <span class="op">&lt;-</span> <span class="va">salextract</span><span class="op">[</span><span class="va">salextract</span><span class="op">[</span>,<span class="st">'species'</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Salmo trutta"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#initial data extraction and preliminary analysis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="pred_extract.html">pred_extract</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">datafinal</span>,</span></span>
<span class="r-in"><span>                      raster<span class="op">=</span> <span class="va">worldclim</span> ,</span></span>
<span class="r-in"><span>                      lat <span class="op">=</span> <span class="st">'decimalLatitude'</span>,</span></span>
<span class="r-in"><span>                      lon<span class="op">=</span> <span class="st">'decimalLongitude'</span>,</span></span>
<span class="r-in"><span>                      colsp <span class="op">=</span> <span class="st">'species'</span>,</span></span>
<span class="r-in"><span>                      bbox  <span class="op">=</span> <span class="va">db</span>,</span></span>
<span class="r-in"><span>                      multiple <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                      minpts <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                      list<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                      merge<span class="op">=</span><span class="cn">F</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#apply ensemble outlier detection. Note: (x and y in exclude parameter are</span></span></span>
<span class="r-in"><span><span class="co">#internally generally in pred_extract during environmental data extraction )</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">outliersdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="multidetect.html">multidetect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rdata</span>, multiple <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                          var <span class="op">=</span> <span class="st">'bio6'</span>,</span></span>
<span class="r-in"><span>                          output <span class="op">=</span> <span class="st">'outlier'</span>,</span></span>
<span class="r-in"><span>                          exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>,<span class="st">'y'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'zscore'</span>, <span class="st">'adjbox'</span>,<span class="st">'iqr'</span>, <span class="st">'semiqr'</span>,<span class="st">'hampel'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">modeout</span> <span class="op">&lt;-</span> <span class="fu">modelcomparison</span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">rdata</span>, outliers <span class="op">=</span> <span class="va">outliersdf</span>, raster <span class="op">=</span> <span class="va">worldclim</span>,</span></span>
<span class="r-in"><span>                           lat <span class="op">=</span> <span class="st">'y'</span>, lon <span class="op">=</span> <span class="st">'x'</span>, models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GLM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                           mode <span class="op">=</span> <span class="st">'best'</span>, testprop <span class="op">=</span> <span class="fl">0.2</span>, metrics <span class="op">=</span> <span class="st">'all'</span>,</span></span>
<span class="r-in"><span>                           thresholds <span class="op">=</span> <span class="fl">0.2</span>, full <span class="op">=</span> <span class="cn">FALSE</span>, minpts <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">getper</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_performance.html">get_performance</a></span><span class="op">(</span>modeloutput <span class="op">=</span> <span class="va">modeout</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="ggperform.html">ggperform</a></span><span class="op">(</span>modelout <span class="op">=</span> <span class="va">modeout</span>, cutoff <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by x x.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

