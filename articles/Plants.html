<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Detecting environmental outliers in species distribution models for plants. • specleanr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detecting environmental outliers in species distribution models for plants.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">specleanr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/addspeciesecologicalranges.html">Flag outliers based on species ecological ranges.</a></li>
    <li><a class="dropdown-item" href="../articles/eOutlier.html">Environmental outlier detection with bootstrapping and principal component analysis.</a></li>
    <li><a class="dropdown-item" href="../articles/generaloutlier.html">General outlier detection for univariate datasets</a></li>
    <li><a class="dropdown-item" href="../articles/loessmethodoptimisation.html">Optimising the LOESS method used for automatic identification of the outlier thresholds.</a></li>
    <li><a class="dropdown-item" href="../articles/Plants.html">Detecting environmental outliers in species distribution models for plants.</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AnthonyBasooma/specleanr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Detecting environmental outliers in species distribution models for plants.</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AnthonyBasooma/specleanr/blob/master/vignettes/Plants.Rmd" class="external-link"><code>vignettes/Plants.Rmd</code></a></small>
      <div class="d-none name"><code>Plants.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://anthonybasooma.github.io/specleanr/">specleanr</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Detect environmental outliers for species occurrences in
<em>Fagus sylvatica</em>, and <em>Populus nigra</em> records based on
bioclimatic data</strong>.</p>
<p>To test the workflow on two plant species, namely the black poplar
(<em>Populus nigra</em>) , which is a pioneer wind-pollinated deciduous
tree from the Salicaceae family (de Rigo et al., 2016). The tree is
distributed across Europe, Asia, and northern Africa (de Rigo et al.,
2016; Harvey-Brown et al., 2017) and predominantly in flood plains in
mixed forests (Harvey-Brown et al., 2017). The mature tree lives up to
300 to 400 years (de Rigo et al., 2016), and it has been assessed as
data deficient according to IUCN RedList (Harvey-Brown et al., 2017).
Secondly, we considered the European beech or common beech (<em>Fagus
sylvatica</em>), which is also a deciduous hardy tree species that can
tolerate various soil habitats but is not tolerant of waterlogged areas
(Barstow et al., 2018). Although mature individuals have declined, the
tree species IUCN RedList threat status is assessed as Least Concern
(Barstow et al., 2018).</p>
<div class="section level3">
<h3 id="data-acquisition-a-species-records">1. Data acquisition: a) species records<a class="anchor" aria-label="anchor" href="#data-acquisition-a-species-records"></a>
</h3>
<p>Data was retrieved from the iNaturalist (<a href="https://www.inaturalist.org/" class="external-link uri">https://www.inaturalist.org/</a>) and Global Biodiversity
Information Facility-GBIF (<a href="https://www.gbif.org/" class="external-link uri">https://www.gbif.org/</a>). We use the
<strong><code><a href="../reference/getdata.html">getdata()</a></code></strong> function, built around rvertnet,
rgbif, and rinat packages. We limited the occurrence records from GBIF
to 700 and iNaturalist to 100. * <strong>Note</strong>: If the user has
locally saved data, then after extracting the online data, the
<strong><code><a href="../reference/match_datasets.html">match_datasets()</a></code></strong> function can be used to
merge all the data sets.</p>
<ul>
<li>We set the bounding box <strong><code>(extent)</code></strong>
parameter for <strong><code><a href="../reference/getdata.html">getdata()</a></code></strong> to return only
records within the Danube basin. However, the user can set this to suit
the area of concern. If not set, the user data will download records
globally, which is time-consuming and likely to break during the
download. Therefore, it is strongly advisable to set the
<strong><code>bounding box</code></strong>. Also, if a shapefile is
available, the user can provide it instead of the bounding box, and the
function will automatically extract the bounding box.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">plantdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getdata.html">getdata</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"Populus nigra"</span>, <span class="st">"Fagus sylvatica"</span><span class="op">)</span>, </span>
<span>                    gbiflim <span class="op">=</span> <span class="fl">700</span>, inatlim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                     hasCoordinate <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                   extent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">8.15250</span>, ymin <span class="op">=</span> <span class="fl">42.08333</span>, xmax<span class="op">=</span><span class="fl">29.73583</span>, ymax <span class="op">=</span> <span class="fl">50.24500</span><span class="op">)</span>,</span>
<span>                   verbose <span class="op">=</span> <span class="cn">FALSE</span>, warn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-acquisition-b-environmental-predictors">1. Data acquisition: b) Environmental predictors<a class="anchor" aria-label="anchor" href="#data-acquisition-b-environmental-predictors"></a>
</h3>
<p>We used WORLDCLIM data archived in the package to enable users to
test the package functions seamlessly. For direct interaction with the
WORDCLIM data, please visit (<a href="https://www.worldclim.org/" class="external-link uri">https://www.worldclim.org/</a>) and the
<strong><code>geodata</code></strong> package for download in
user-customized workflows. WORLDCLIM data has 19 bioclimatic variables
(<a href="https://www.worldclim.org/data/bioclim.html" class="external-link uri">https://www.worldclim.org/data/bioclim.html</a>) (Amatulli
et al., 2022), including</p>
<ul>
<li>
<code>BIO1</code> = Annual Mean Temperature</li>
<li>
<code>BIO2</code> = Mean Diurnal Range (Mean of monthly (max temp -
min temp))</li>
<li>
<code>BIO3</code> = Isothermality (BIO2/BIO7) (×100)</li>
<li>
<code>BIO4</code> = Temperature Seasonality (standard deviation
×100)</li>
<li>
<code>BIO5</code> = Max Temperature of Warmest Month</li>
<li>
<code>BIO6</code> = Min Temperature of Coldest Month</li>
<li>
<code>BIO7</code> = Temperature Annual Range (BIO5-BIO6)</li>
<li>
<code>BIO8</code> = Mean Temperature of Wettest Quarter</li>
<li>
<code>BIO9</code> = Mean Temperature of Driest Quarter</li>
<li>
<code>BIO10</code> = Mean Temperature of Warmest Quarter</li>
<li>
<code>BIO11</code> = Mean Temperature of Coldest Quarter</li>
<li>
<code>BIO12</code> = Annual Precipitation</li>
<li>
<code>BIO13</code> = Precipitation of Wettest Month</li>
<li>
<code>BIO14</code> = Precipitation of Driest Month</li>
<li>
<code>BIO15</code> = Precipitation Seasonality (Coefficient of
Variation)</li>
<li>
<code>BIO16</code> = Precipitation of Wettest Quarter</li>
<li>
<code>BIO17</code> = Precipitation of Driest Quarter</li>
<li>
<code>BIO18</code> = Precipitation of Warmest Quarter</li>
<li>
<code>BIO19</code> = Precipitation of Coldest Quarter</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Get climatic variables from the package folder</span></span>
<span></span>
<span><span class="va">worldclim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/worldclim.tiff'</span>, package <span class="op">=</span> <span class="st">'specleanr'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">worldclim</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">worldclim</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="preliminary-analysis">2. Preliminary analysis<a class="anchor" aria-label="anchor" href="#preliminary-analysis"></a>
</h3>
<p>The step involves removing missing coordinate values, setting the
geographical range for the data collated in <strong>1.a</strong>, if the
user did not set the bounding box during data download. After that, the
environmental data predictors are extracted. The user can set either
parameter <strong>list = TRUE</strong> to return a list of datasets for
each species, if multiple species are considered, or <strong>list =
FALSE</strong> to return a combined dataframe. The Danube basin was
collated from the Hydrography90m basin files (<a href="https://hydrography.org/hydrography90m/hydrography90m_layers" class="external-link uri">https://hydrography.org/hydrography90m/hydrography90m_layers</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">danube_basin</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">"danube.shp.zip"</span>, package <span class="op">=</span> <span class="st">'specleanr'</span><span class="op">)</span>, </span>
<span>                            quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Environmental predictors extraction for multiple species (multiple = TRUE)</span></span>
<span></span>
<span><span class="va">multspreference_data</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/pred_extract.html">pred_extract</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">plantdf</span>, </span>
<span>                             raster<span class="op">=</span> <span class="va">worldclim</span>, </span>
<span>                             lat <span class="op">=</span> <span class="st">'decimalLatitude'</span>,</span>
<span>                             lon <span class="op">=</span> <span class="st">'decimalLongitude'</span>,</span>
<span>                             colsp <span class="op">=</span> <span class="st">'species'</span>,  </span>
<span>                             bbox <span class="op">=</span> <span class="va">danube_basin</span>,</span>
<span>                             list<span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                             minpts <span class="op">=</span> <span class="fl">10</span>, merge <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, warn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Environmental prediction extraction for a single species (multiple = FALSE)</span></span>
<span><span class="va">fagus_data_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">plantdf</span>, <span class="va">species</span><span class="op">==</span><span class="st">"Fagus sylvatica"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fagus_data_reference</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/pred_extract.html">pred_extract</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">fagus_data_filtered</span>, </span>
<span>                             raster<span class="op">=</span> <span class="va">worldclim</span>, </span>
<span>                             lat <span class="op">=</span> <span class="st">'decimalLatitude'</span>,</span>
<span>                             lon <span class="op">=</span> <span class="st">'decimalLongitude'</span>,</span>
<span>                             colsp <span class="op">=</span> <span class="st">'species'</span>,  </span>
<span>                             bbox <span class="op">=</span> <span class="va">danube_basin</span>, </span>
<span>                             minpts <span class="op">=</span> <span class="fl">10</span>, merge <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                           verbose <span class="op">=</span> <span class="cn">FALSE</span>, warn <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="detecting-outliers-using-multiple-outlier-detection-methods">3. Detecting outliers using multiple outlier detection methods<a class="anchor" aria-label="anchor" href="#detecting-outliers-using-multiple-outlier-detection-methods"></a>
</h3>
<ul>
<li>To detect outliers we selected ensembled seven outlier detection
methods at least from different categories i.e., 1) <strong>univariate
methods</strong>: adjusted boxplot
<strong><code>adjbox()</code></strong>, Hampel filter:
<strong><code><a href="../reference/hampel.html">hampel()</a></code></strong>, Z-score
<strong><code><a href="../reference/zscore.html">zscore()</a></code></strong> and reverse jackknifing
<strong><code><a href="../reference/jknife.html">jknife()</a></code></strong>; 2) <strong>Multivariate methods
or machine learning models</strong>: local outlier factor:
<strong><code>lof()</code></strong>, K-means:
<strong><code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans()</a></code></strong>, and Mahalanobis distance measure
<strong><code><a href="../reference/mahal.html">mahal()</a></code></strong>.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Flag outlier in single species data (multiple = TRUE)</span></span>
<span><span class="va">multspp_outliers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidetect.html">multidetect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">multspreference_data</span>,</span>
<span>                       multiple <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       var <span class="op">=</span> <span class="st">'bio1'</span>,</span>
<span>                       output <span class="op">=</span> <span class="st">'outlier'</span>,</span>
<span>                       exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>,<span class="st">'y'</span><span class="op">)</span>, </span>
<span>                       methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'adjbox'</span>, <span class="st">"hampel"</span>, <span class="st">'zscore'</span>, </span>
<span>                                   <span class="st">'lof'</span>, <span class="st">'jknife'</span>, <span class="st">'kmeans'</span>, <span class="st">'mahal'</span><span class="op">)</span>,</span>
<span>                       silence_true_errors <span class="op">=</span> <span class="cn">FALSE</span>, warn <span class="op">=</span> <span class="cn">F</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Flag outlier in single species data (multiple = FALSE)</span></span>
<span></span>
<span><span class="va">fagus_outliers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidetect.html">multidetect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fagus_data_reference</span>,</span>
<span>                       multiple <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       var <span class="op">=</span> <span class="st">'bio1'</span>,</span>
<span>                       output <span class="op">=</span> <span class="st">'outlier'</span>,</span>
<span>                       exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>,<span class="st">'y'</span><span class="op">)</span>, </span>
<span>                       methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'adjbox'</span>, <span class="st">"hampel"</span>, <span class="st">'zscore'</span>, </span>
<span>                                   <span class="st">'lof'</span>, <span class="st">'jknife'</span>, <span class="st">'kmeans'</span>, <span class="st">'mahal'</span><span class="op">)</span>,</span>
<span>                       silence_true_errors <span class="op">=</span> <span class="cn">FALSE</span>, warn <span class="op">=</span> <span class="cn">F</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-outliers-flagged-by-each-method">Visualizing outliers flagged by each method<a class="anchor" aria-label="anchor" href="#visualizing-outliers-flagged-by-each-method"></a>
</h3>
<p>The plots are wrapped on a ggplot2 object and extensible with ggplot2
parameters. The <strong><code>ggoultiers()</code></strong> takes in 3
parameters: <strong>1: x</strong> the outlier object of
<strong><code>datacleaner class</code></strong>; <strong>2: y</strong>
the index or species name if the outlier has more than one species, and
<strong>3: raw</strong> to either indicate the number of outlier if
<strong>TRUE</strong> or proportional or outliers flagged about total
number of occurrences if <strong>FALSE</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/ggoutliers.html">ggoutliers</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">multspp_outliers</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plants_files/figure-html/visualize%20outliers-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#for one species: no index needed</span></span>
<span><span class="fu"><a href="../reference/ggoutliers.html">ggoutliers</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">fagus_outliers</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plants_files/figure-html/visualize%20outliers-2.png" width="576" style="display: block; margin: auto;">
### Identify the best threshold using loess model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">optimal1</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_threshold.html">optimal_threshold</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">fagus_data_reference</span>, outliers <span class="op">=</span> <span class="va">fagus_outliers</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plants_files/figure-html/threshold%20identifcation-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">optimalthreshold</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_threshold.html">optimal_threshold</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">multspreference_data</span>, outliers <span class="op">=</span> <span class="va">multspp_outliers</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extracting-clean-data-set-after-outlier-detection">4. Extracting clean data set after outlier detection<a class="anchor" aria-label="anchor" href="#extracting-clean-data-set-after-outlier-detection"></a>
</h3>
<ul>
<li>The mode can be set to <strong>mode = abs</strong> to discard only
absolute outliers or <strong>mode = best</strong> to use the best
method. The outlier flagged by the best method will be used to clean the
data. For more information, check (Basooma et al., 2025).</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">multspp_qc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_clean_data.html">extract_clean_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">multspreference_data</span>, </span>
<span>                                      outliers <span class="op">=</span> <span class="va">multspp_outliers</span>,</span>
<span>                                      loess <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multspp_qc_label</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify_data.html">classify_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">multspreference_data</span>, </span>
<span>                                      outliers <span class="op">=</span> <span class="va">multspp_outliers</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fagus_qc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_clean_data.html">extract_clean_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">fagus_data_reference</span>, </span>
<span>                                    outliers <span class="op">=</span> <span class="va">fagus_outliers</span>,</span>
<span>                                    loess <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fagus_qc_label</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify_data.html">classify_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">fagus_data_reference</span>, </span>
<span>                                    outliers <span class="op">=</span> <span class="va">fagus_outliers</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualising-records-in-environmental-space">Visualising records in environmental space<a class="anchor" aria-label="anchor" href="#visualising-records-in-environmental-space"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#for single species</span></span>
<span><span class="fu"><a href="../reference/ggenvironmentalspace.html">ggenvironmentalspace</a></span><span class="op">(</span>qcdata <span class="op">=</span> <span class="va">fagus_qc_label</span>,</span>
<span>                     xvar <span class="op">=</span> <span class="st">'bio1'</span>,</span>
<span>                     yvar <span class="op">=</span> <span class="st">"bio18"</span>,</span>
<span>                     xlab <span class="op">=</span> <span class="st">"Annual mean temperature"</span>,</span>
<span>                     ylab <span class="op">=</span> <span class="st">"Precipitation of Warmest Quarter"</span>,</span>
<span>                     scalecolor <span class="op">=</span> <span class="st">'viridis'</span>,</span>
<span>                     pointsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plants_files/figure-html/2d%20plots%20single%20species-1.png" width="518.4" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#for single species</span></span>
<span><span class="fu"><a href="../reference/ggenvironmentalspace.html">ggenvironmentalspace</a></span><span class="op">(</span>qcdata <span class="op">=</span> <span class="va">multspp_qc_label</span>,</span>
<span>                     xvar <span class="op">=</span> <span class="st">'bio1'</span>,</span>
<span>                     yvar <span class="op">=</span> <span class="st">"bio18"</span>,</span>
<span>                     xlab <span class="op">=</span> <span class="st">"Annual mean temperature"</span>,</span>
<span>                     ylab <span class="op">=</span> <span class="st">"Precipitation of Warmest Quarter"</span>,</span>
<span>                     scalecolor <span class="op">=</span> <span class="st">'viridis'</span>,</span>
<span>                     pointsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plants_files/figure-html/2d%20plots%20multiple%20species-1.png" width="710.4" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="visualising-records-in-environmental-space-in-3d">Visualising records in environmental space in 3d<a class="anchor" aria-label="anchor" href="#visualising-records-in-environmental-space-in-3d"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#for single species</span></span>
<span><span class="fu"><a href="../reference/ggenvironmentalspace.html">ggenvironmentalspace</a></span><span class="op">(</span>qcdata <span class="op">=</span> <span class="va">fagus_qc_label</span>,</span>
<span>                     xvar <span class="op">=</span> <span class="st">'bio1'</span>,</span>
<span>                     yvar <span class="op">=</span> <span class="st">"bio18"</span>,</span>
<span>                     zvar <span class="op">=</span> <span class="st">'bio6'</span>,</span>
<span>                     type <span class="op">=</span> <span class="st">"3d"</span>,</span>
<span>                     labelvar <span class="op">=</span> <span class="st">"label"</span>,</span>
<span>                     xlab <span class="op">=</span> <span class="st">"Annual mean temperature"</span>,</span>
<span>                     ylab <span class="op">=</span> <span class="st">"Precipitation of Warmest Quarter"</span>,</span>
<span>                     zlab <span class="op">=</span> <span class="st">"Min Temperature of Coldest Month"</span>,</span>
<span>                     scalecolor <span class="op">=</span> <span class="st">'viridis'</span>,</span>
<span>                     lpos3d <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>                     pointsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Plants_files/figure-html/3d%20plots%20single%20species-1.png" width="710.4" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Amatulli, Giuseppe, et al. “Hydrography90m: A new high-resolution
global hydrographic dataset.” Earth System Science Data 14.10 (2022):
4525-4550.</p></li>
<li><p>Harvey-Brown, Y., Barstow, M., Mark, J. &amp; Rivers, M.C. 2017.
Populus nigra. The IUCN Red List of Threatened Species 2017:
e.T63530A68106816. <a href="https://dx.doi.org/10.2305/IUCN.UK.2017-3.RLTS.T63530A68106816.en" class="external-link uri">https://dx.doi.org/10.2305/IUCN.UK.2017-3.RLTS.T63530A68106816.en</a>.
Accessed on 24 June 2024.</p></li>
<li><p>de Rigo, D., Enescu, C.M., Houston Durrant, T. and Caudullo, G.
2016. Populus nigra in Europe: distribution, habitat, usage and threats.
European Atlas of Forest Tree Species, Publications Office of the
European Union, Luxembourg.</p></li>
<li><p>Barstow, M. &amp; Beech, E. 2018. Fagus sylvatica. The IUCN Red
List of Threatened Species 2018: e.T62004722A62004725. <a href="https://dx.doi.org/10.2305/IUCN.UK.2018-1.RLTS.T62004722A62004725.en" class="external-link uri">https://dx.doi.org/10.2305/IUCN.UK.2018-1.RLTS.T62004722A62004725.en</a>.
Accessed on 24 June 2024.</p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anthony Basooma, Thomas Hein, Astrid Schmidt-Kloiber, Florian Borgwardt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
