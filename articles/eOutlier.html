<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Environmental outlier detection with bootstrapping and principal component analysis. â€¢ specleanr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Environmental outlier detection with bootstrapping and principal component analysis.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">specleanr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/addspeciesecologicalranges.html">Flag outliers based on species ecological ranges.</a></li>
    <li><a class="dropdown-item" href="../articles/eOutlier.html">Environmental outlier detection with bootstrapping and principal component analysis.</a></li>
    <li><a class="dropdown-item" href="../articles/generaloutlier.html">General outlier detection for univariate datasets</a></li>
    <li><a class="dropdown-item" href="../articles/loessmethodoptimisation.html">Optimising the LOESS method used for automatic identification of the outlier thresholds.</a></li>
    <li><a class="dropdown-item" href="../articles/Plants.html">Detecting environmental outliers in species distribution models for plants.</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/AnthonyBasooma/specleanr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Environmental outlier detection with bootstrapping and principal component analysis.</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AnthonyBasooma/specleanr/blob/master/vignettes/eOutlier.Rmd" class="external-link"><code>vignettes/eOutlier.Rmd</code></a></small>
      <div class="d-none name"><code>eOutlier.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://anthonybasooma.github.io/specleanr/">specleanr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="environmental-outlier-check-for-fish-species-from-the-danube-river-basin">Environmental outlier check for fish species from the Danube River
Basin<a class="anchor" aria-label="anchor" href="#environmental-outlier-check-for-fish-species-from-the-danube-river-basin"></a>
</h2>
<p>The workflow for environmental outlier detection and removal is
similar across taxa, regions, or ecological realms. However, we included
the <strong><code><a href="../reference/check_names.html">check_names()</a></code></strong> function to cater for
fish species names exhaustively. In this worked example, we tried the
functionalities on the fish species from the Danube River Basin, with
extracts of species records from Joint Danube Survey (JDS) and EFI+ data
archived in the package. We complimented the data with fish species
occurrences from online sources including Global Biodiversity
Information Facility (GBIF), iNaturalist, and VertNET using the
<strong><code><a href="../reference/getdata.html">getdata()</a></code></strong> function. They are basically
five steps, including: 1) Data acquisition and harmonization; 2)
Precleaning and predictor extraction 3) outlier detection 4)
identification of clean data and suitable method 5) developing species
distribution models (optional).</p>
<div class="section level3">
<h3 id="scope-of-application">Scope of application<a class="anchor" aria-label="anchor" href="#scope-of-application"></a>
</h3>
<p>In this workflow, we provide three approaches that can be used to
handle outlier detection, namely 1) the default approach (no
bootstrapping and principal component analysis applied); 2)
bootstrapping applied during outlier detection mostly for fewer records
(user based to set the records) and 3) combining principal component
analysis and bootstrapping. Because each approach will significantly
affect how records are flagged as outliers, its upon the user to select
an approach to use. However, we advise users to apply bootstrapping and
PCA if the particular suspicious records are still not handled in the
first approach.</p>
</div>
<div class="section level3">
<h3 id="data-acquisition-a-collate-species-species-records-offline-and-online-data">1.Data acquisition: a) Collate species species records: offline and
online data<a class="anchor" aria-label="anchor" href="#data-acquisition-a-collate-species-species-records-offline-and-online-data"></a>
</h3>
<p>The species records were obtained from the archived datasets
extracted from the Joint Danube Survey (<a href="https://www.danubesurvey.org/jds4/" class="external-link uri">https://www.danubesurvey.org/jds4/</a>) and EFIPLUS (Logez
et al., 2012). To compliment species records, we used the
<strong><code><a href="../reference/getdata.html">getdata()</a></code></strong> function to retrieve data from
the GBIF (<a href="https://www.gbif.org/" class="external-link uri">https://www.gbif.org/</a>), VertNet (<a href="http://www.vertnet.org/" class="external-link uri">http://www.vertnet.org/</a>)
and iNaturalist ( <a href="https://www.inaturalist.org/" class="external-link uri">https://www.inaturalist.org/</a>) for <em>Squalius
cephalus</em>, <em>Salmo trutta</em>, <em>Thymallus thymallus</em>, and
<em>Anguilla anguilla</em>. For online data, we limited data to 50
records from each data source to reduce on the execution time.</p>
<p><strong>NOTE</strong></p>
<p>This workflow may fail if the particular settings such as blocking of
IP address to GIBF, iNaturalist, FishBase, and VertNet may prevent user
from accessing the online data. Since, this may differ at user-to-user
basis, it is beyond the scope of this package to address such
limitations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#==========================</span></span>
<span><span class="co">#Step 1ai. Obtain Local data sources (archived in this package)</span></span>
<span><span class="co">#=========================</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efidata</span><span class="op">)</span> <span class="co">#Data extract from EFIPLUS data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">jdsdata</span><span class="op">)</span> <span class="co">#Data extract from JDS4 data </span></span>
<span></span>
<span><span class="co">#===================================</span></span>
<span><span class="co">#Step 1aii: Retrieve online data for the species: polygon to limit the extent to get records.</span></span>
<span><span class="co">#=====================================</span></span>
<span><span class="va">danube</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">"danube.shp.zip"</span>,</span>
<span>                                  package <span class="op">=</span> <span class="st">'specleanr'</span><span class="op">)</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">df_online</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getdata.html">getdata</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Squalius cephalus"</span>, <span class="st">'Salmo trutta'</span>, </span>
<span>                              <span class="st">"Thymallus thymallus"</span>,<span class="st">"Anguilla anguilla"</span><span class="op">)</span>, </span>
<span>                                extent <span class="op">=</span> <span class="va">danube</span>,</span>
<span>                                gbiflim <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                                inatlim <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                                vertlim <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                     verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">df_online</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 400   8</span></span></code></pre></div>
<div class="section level4">
<h4 id="merging-and-harmonizing-species-records-from-different-sources">Merging and harmonizing species records from different sources<a class="anchor" aria-label="anchor" href="#merging-and-harmonizing-species-records-from-different-sources"></a>
</h4>
<p>The online data sources from <strong><code><a href="../reference/getdata.html">getdata()</a></code></strong>
and local files are merged using the
<strong><code><a href="../reference/match_datasets.html">match_datasets()</a></code></strong> function. Five columns
are harmonized while combining data from different sources: the country,
species names, latitude/longitude columns, and dates. The Darwin Core
standard names are country, species, decimalLatitude, decimalLongitude,
and dates (Wieczorek et al., 2012). So, if the local dataset has a
different name for standard names, the user should indicate it. For
example, in JDS data, the species column is labeled
<strong>speciesname</strong>, shown in the species parameter for
automatic renaming and merging with other datasets. * Note: The user
should indicate all dataset names in the list. *
<code><a href="../reference/check_names.html">check_names()</a></code> is used to clean species names in terms of
synonyms or spellings, based on FishBase (<a href="https://www.fishbase.se/" class="external-link uri">https://www.fishbase.se/</a>). This function generates
another column <strong>speciescheck</strong> that contain the clean
names.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mergealldfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/match_datasets.html">match_datasets</a></span><span class="op">(</span>datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>efi<span class="op">=</span> <span class="va">efidata</span>, jds <span class="op">=</span> <span class="va">jdsdata</span>, </span>
<span>                                        onlinedata <span class="op">=</span> <span class="va">df_online</span><span class="op">)</span>,</span>
<span>                country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'JDS4_sampling_ID'</span><span class="op">)</span>,</span>
<span>                lats <span class="op">=</span> <span class="st">'lat'</span>, lons <span class="op">=</span> <span class="st">'lon'</span>,</span>
<span>                species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'speciesname'</span>, <span class="st">'scientificName'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Species names are re-cleaned since the species names from vertnet are changed.</span></span>
<span></span>
<span><span class="va">cleannames_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_names.html">check_names</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mergealldfs</span>, colsp <span class="op">=</span> <span class="st">'species'</span>, pct <span class="op">=</span> <span class="fl">90</span>, </span>
<span>                             merge <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The synoynm Salmo trutta fario will be replaced with Salmo trutta.</span></span>
<span><span class="co">#&gt; The synoynm Salmo trutta lacustris will be replaced with Salmo trutta.</span></span>
<span><span class="co">#&gt; The synoynm Aspius aspius will be replaced with Leuciscus aspius.</span></span>
<span></span>
<span><span class="co">#Filter out species from clean names df where the species names such as synonyms like Salmo trutta fario chnaged to Slamo trutta</span></span>
<span></span>
<span><span class="va">speciesfiltered</span> <span class="op">&lt;-</span> <span class="va">cleannames_df</span><span class="op">[</span><span class="va">cleannames_df</span><span class="op">$</span><span class="va">speciescheck</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>                                   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Squalius cephalus"</span>, <span class="st">'Salmo trutta'</span>, </span>
<span>                                     <span class="st">"Thymallus thymallus"</span>,<span class="st">"Anguilla anguilla"</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="data-acquisition-b-environmental-predictors-from-worldclim">1. <strong>Data acquisition: b) Environmental predictors from
worldclim</strong><a class="anchor" aria-label="anchor" href="#data-acquisition-b-environmental-predictors-from-worldclim"></a>
</h3>
<p>We used WORLDCLIM data archived in the package to enable users to
test the package functions seamlessly. For direct interaction with the
WORDCLIM data, please visit (<a href="https://www.worldclim.org/" class="external-link uri">https://www.worldclim.org/</a>) and the
<strong><code>geodata</code></strong> package for download in
user-customized workflows. WORLDCLIM data has 19 bioclimatic variables
(<a href="https://www.worldclim.org/data/bioclim.html" class="external-link uri">https://www.worldclim.org/data/bioclim.html</a>),
including;</p>
<ul>
<li>
<code>BIO1</code> = Annual Mean Temperature</li>
<li>
<code>BIO2</code> = Mean Diurnal Range (Mean of monthly (max temp -
min temp))</li>
<li>
<code>BIO3</code> = Isothermality (BIO2/BIO7) (Ã—100)</li>
<li>
<code>BIO4</code> = Temperature Seasonality (standard deviation
Ã—100)</li>
<li>
<code>BIO5</code> = Max Temperature of Warmest Month</li>
<li>
<code>BIO6</code> = Min Temperature of Coldest Month</li>
<li>
<code>BIO7</code> = Temperature Annual Range (BIO5-BIO6)</li>
<li>
<code>BIO8</code> = Mean Temperature of Wettest Quarter</li>
<li>
<code>BIO9</code> = Mean Temperature of Driest Quarter</li>
<li>
<code>BIO10</code> = Mean Temperature of Warmest Quarter</li>
<li>
<code>BIO11</code> = Mean Temperature of Coldest Quarter</li>
<li>
<code>BIO12</code> = Annual Precipitation</li>
<li>
<code>BIO13</code> = Precipitation of Wettest Month</li>
<li>
<code>BIO14</code> = Precipitation of Driest Month</li>
<li>
<code>BIO15</code> = Precipitation Seasonality (Coefficient of
Variation)</li>
<li>
<code>BIO16</code> = Precipitation of Wettest Quarter</li>
<li>
<code>BIO17</code> = Precipitation of Driest Quarter</li>
<li>
<code>BIO18</code> = Precipitation of Warmest Quarter</li>
<li>
<code>BIO19</code> = Precipitation of Coldest Quarter</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Get climatic variables from the package folder</span></span>
<span></span>
<span><span class="va">worldclim</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/worldclim.tiff'</span>, package <span class="op">=</span> <span class="st">'specleanr'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="precleaning-and-environmental-data-extraction">2. Precleaning and environmental data extraction<a class="anchor" aria-label="anchor" href="#precleaning-and-environmental-data-extraction"></a>
</h3>
<p>Here,</p>
<ul>
<li><p>The duplicate records are removed if points they are obtained
from the same location for the same species.</p></li>
<li><p>The missing values coordinates are removed.</p></li>
<li><p>The environmental predictors are extracted from the raster layers
(WORLDCLIM).</p></li>
<li><p>The user can set the minimum point for the species to be retianed
for further analyis.</p></li>
<li><p>The bounding box can be set to limit the extent of data
extraction. For this case, we used the basin layer for the Danube Basin
was obtained from Hydrography90m (<a href="https://hydrography.org/hydrography90m/hydrography90m_layers" class="external-link uri">https://hydrography.org/hydrography90m/hydrography90m_layers</a>).</p></li>
<li><p>The user can either return a dataframe or list of the cleaned
data. Important in the next steps.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Get basin shapefile to delineate the study region: optional</span></span>
<span></span>
<span><span class="va">danube</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'danube.shp.zip'</span>, </span>
<span>                                  package <span class="op">=</span> <span class="st">'specleanr'</span><span class="op">)</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#For multiple species indicate multiple TRUE</span></span>
<span><span class="va">multipreclened</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/pred_extract.html">pred_extract</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">speciesfiltered</span>, </span>
<span>                             raster<span class="op">=</span> <span class="va">worldclim</span>, </span>
<span>                             lat <span class="op">=</span> <span class="st">'decimalLatitude'</span>,</span>
<span>                             lon <span class="op">=</span> <span class="st">'decimalLongitude'</span>,</span>
<span>                             colsp <span class="op">=</span> <span class="st">'speciescheck'</span>,</span>
<span>                             bbox  <span class="op">=</span> <span class="va">danube</span>,  </span>
<span>                             list<span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                             minpts <span class="op">=</span> <span class="fl">10</span>, merge <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">multipreclened</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Anguilla anguilla"   "Salmo trutta"        "Squalius cephalus"  </span></span>
<span><span class="co">#&gt; [4] "Thymallus thymallus"</span></span>
<span></span>
<span></span>
<span><span class="va">thymallusdata</span> <span class="op">&lt;-</span> <span class="va">speciesfiltered</span><span class="op">[</span><span class="va">speciesfiltered</span><span class="op">[</span>,<span class="st">'speciescheck'</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Thymallus thymallus"</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">thymallusdata</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 130   7</span></span>
<span></span>
<span><span class="va">thymallus_referencedata</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/pred_extract.html">pred_extract</a></span><span class="op">(</span>data<span class="op">=</span> <span class="va">thymallusdata</span>, raster<span class="op">=</span> <span class="va">worldclim</span>, </span>
<span>                             lat <span class="op">=</span> <span class="st">'decimalLatitude'</span>,</span>
<span>                             lon <span class="op">=</span> <span class="st">'decimalLongitude'</span>,</span>
<span>                             colsp <span class="op">=</span> <span class="st">'speciescheck'</span>,</span>
<span>                             bbox  <span class="op">=</span> <span class="va">danube</span>,</span>
<span>                             list<span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                             minpts <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">thymallus_referencedata</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 96 21</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="outlier-detection-for-both-single-and-multiple-species-no-pca-or-bootstrapping">3. Outlier detection for both single and multiple species (No PCA or
bootstrapping)<a class="anchor" aria-label="anchor" href="#outlier-detection-for-both-single-and-multiple-species-no-pca-or-bootstrapping"></a>
</h3>
<p>Multiple outlier detection are set. This package contains 20 outlier
detection methods and the user can run
<strong><code><a href="../reference/extractMethods.html">extractMethods()</a></code></strong> to get the allowed
methods. They are categorized into univariate, multivariate and species
ecological ranges. * <code>var</code> is the predictor to be used
univariate methods. * <code>exclude</code> allows to remove predictors
that user deems unnecessary. For example, the coordinates, since the
multivariate methods consider the whole dataset.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#For multiple species: default settings</span></span>
<span></span>
<span><span class="va">multiple_spp_out_detection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidetect.html">multidetect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">multipreclened</span>,</span>
<span>                      multiple <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      var <span class="op">=</span> <span class="st">'bio6'</span>,</span>
<span>                     exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>,<span class="st">'y'</span><span class="op">)</span>,</span>
<span>                      methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'zscore'</span>, <span class="st">'adjbox'</span>,</span>
<span>                                                <span class="st">'logboxplot'</span>, <span class="st">'distboxplot'</span>,</span>
<span>                                                <span class="st">'iqr'</span>, <span class="st">'semiqr'</span>,</span>
<span>                                                <span class="st">'hampel'</span>,<span class="st">'kmeans'</span>,</span>
<span>                                                <span class="st">'jknife'</span>, <span class="st">'onesvm'</span>,</span>
<span>                                                <span class="st">'iforest'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#single species:default settings</span></span>
<span></span>
<span><span class="va">thymallus_outlier_detection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidetect.html">multidetect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thymallus_referencedata</span>,</span>
<span>                      multiple <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      var <span class="op">=</span> <span class="st">'bio6'</span>,</span>
<span>                      output <span class="op">=</span> <span class="st">'outlier'</span>,</span>
<span>                      exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>,<span class="st">'y'</span><span class="op">)</span>,</span>
<span>                      methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'zscore'</span>, <span class="st">'adjbox'</span>,</span>
<span>                                  <span class="st">'logboxplot'</span>, <span class="st">'distboxplot'</span>,</span>
<span>                                  <span class="st">'iqr'</span>, <span class="st">'semiqr'</span>,</span>
<span>                                  <span class="st">'hampel'</span>,<span class="st">'kmeans'</span>,</span>
<span>                                  <span class="st">'jknife'</span>, <span class="st">'onesvm'</span>,</span>
<span>                                  <span class="st">'iforest'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="outlier-visualization-for-single-and-multiple-species">4. Outlier visualization for single and multiple species<a class="anchor" aria-label="anchor" href="#outlier-visualization-for-single-and-multiple-species"></a>
</h3>
<ul>
<li>
<code>ggoutliers</code> are based in ggplot2, so it can be modified
based on user needs. x: is the output for outlier detection, y is the
species name or index for multiple species, and raw = TRUE if the number
of outliers are the displayed, otherwise the proportion of outliers to
the total number of records will be plotted.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#for multiple species</span></span>
<span><span class="fu"><a href="../reference/ggoutliers.html">ggoutliers</a></span><span class="op">(</span><span class="va">multiple_spp_out_detection</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/visualisation-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#for single species</span></span>
<span><span class="fu"><a href="../reference/ggoutliers.html">ggoutliers</a></span><span class="op">(</span><span class="va">thymallus_outlier_detection</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/visualisation-2.png" width="576" style="display: block; margin: auto;"></p>
<p><strong>Identify the best threshold using loess model.</strong></p>
<p>The local regression is used to optimize and identify the best
threshold for denoting the point as an absolute outlier. We fit the
local region model between the data retained at every threshold, and we
identify a maxima when the number of records retain are number of
records retained does not significantly vary with an increased increase
in the threshold.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">thymallus_opt_threshold</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_threshold.html">optimal_threshold</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">thymallus_referencedata</span>, </span>
<span>                               outliers <span class="op">=</span> <span class="va">thymallus_outlier_detection</span>, plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="cn">TRUE</span>, group <span class="op">=</span> <span class="st">"Thymallus thymallus"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/threshold%20identifcation-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#obtain the optimal thresholds for multiple species </span></span>
<span></span>
<span><span class="va">multspp_opt_threshold</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_threshold.html">optimal_threshold</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">multipreclened</span>, </span>
<span>                                           outliers <span class="op">=</span> <span class="va">multiple_spp_out_detection</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extracting-clean-data-from-the-reference-data-precleaned-data-in-step-2-">5. Extracting clean data from the reference data (precleaned data in
step 2).<a class="anchor" aria-label="anchor" href="#extracting-clean-data-from-the-reference-data-precleaned-data-in-step-2-"></a>
</h3>
<p>The user sets a threshold ranging from 0.1 to 1 but its advisable to
set a value above 0.5 to include above 50% of the methods.
<strong>threshold</strong> is the value indicating the proportion of
methods to be used to classify a record as a true outlier. For example,
a threshold of 0.6 means that at least in the 4 of the 6 methods noted
during outlier detection in step 3. We used the loess method for
identifying the optimal threshold.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">multspecies_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_clean_data.html">extract_clean_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">multipreclened</span>, </span>
<span>                                        outliers <span class="op">=</span> <span class="va">multiple_spp_out_detection</span>, </span>
<span>                                        loess <span class="op">=</span>  <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">multspecies_clean</span><span class="op">)</span></span>
<span><span class="co">#&gt;        bio1     bio2     bio3     bio4     bio5     bio6     bio7     bio8</span></span>
<span><span class="co">#&gt; 1  7.765240 8.342354 31.78373 687.5156 21.74550 -4.50175 26.24725 16.19358</span></span>
<span><span class="co">#&gt; 2  8.340094 8.558521 31.95564 691.9463 23.15800 -3.62450 26.78250 15.38925</span></span>
<span><span class="co">#&gt; 3 10.705156 9.007730 30.22804 798.7291 26.63425 -3.16500 29.79925 18.81887</span></span>
<span><span class="co">#&gt; 4  7.765240 8.342354 31.78373 687.5156 21.74550 -4.50175 26.24725 16.19358</span></span>
<span><span class="co">#&gt; 5  7.765240 8.342354 31.78373 687.5156 21.74550 -4.50175 26.24725 16.19358</span></span>
<span><span class="co">#&gt; 6 10.042927 9.046562 30.40682 776.2538 26.19925 -3.55250 29.75175 19.52196</span></span>
<span><span class="co">#&gt;        bio9    bio10       bio11 bio12 bio13 bio14    bio15 bio16 bio17 bio18</span></span>
<span><span class="co">#&gt; 1 0.6048333 16.19358 -0.60591668  1364   175    79 25.91408   479   270   479</span></span>
<span><span class="co">#&gt; 2 1.1871250 16.93192 -0.08562502   789    97    44 28.08648   274   136   274</span></span>
<span><span class="co">#&gt; 3 2.3845417 20.33225  0.70933336   536    60    28 23.59082   169    90   162</span></span>
<span><span class="co">#&gt; 4 0.6048333 16.19358 -0.60591668  1364   175    79 25.91408   479   270   479</span></span>
<span><span class="co">#&gt; 5 0.6048333 16.19358 -0.60591668  1364   175    79 25.91408   479   270   479</span></span>
<span><span class="co">#&gt; 6 1.9554167 19.52196  0.38324997   644    80    35 28.87415   227   111   227</span></span>
<span><span class="co">#&gt;   bio19        x        y            groups</span></span>
<span><span class="co">#&gt; 1   274 13.58333 47.91667 Anguilla anguilla</span></span>
<span><span class="co">#&gt; 2   145 10.08333 48.41667 Anguilla anguilla</span></span>
<span><span class="co">#&gt; 3   104 18.75000 47.41667 Anguilla anguilla</span></span>
<span><span class="co">#&gt; 4   274 13.58333 47.91667 Anguilla anguilla</span></span>
<span><span class="co">#&gt; 5   274 13.58333 47.91667 Anguilla anguilla</span></span>
<span><span class="co">#&gt; 6   115 16.91667 48.25000 Anguilla anguilla</span></span>
<span></span>
<span><span class="va">thymallus_qcdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_clean_data.html">extract_clean_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">thymallus_referencedata</span>, </span>
<span>                             outliers <span class="op">=</span> <span class="va">thymallus_outlier_detection</span>, </span>
<span>                             loess <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">multiple_spp_qcdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify_data.html">classify_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">multipreclened</span>, </span>
<span>                                outliers <span class="op">=</span> <span class="va">multiple_spp_out_detection</span>, </span>
<span>                                EIF <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">multiple_spp_qcdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;       bio1     bio2     bio3     bio4     bio5     bio6     bio7     bio8</span></span>
<span><span class="co">#&gt; 1 7.765240 8.342354 31.78373 687.5156 21.74550 -4.50175 26.24725 16.19358</span></span>
<span><span class="co">#&gt; 2 8.340094 8.558521 31.95564 691.9463 23.15800 -3.62450 26.78250 15.38925</span></span>
<span><span class="co">#&gt; 4 7.765240 8.342354 31.78373 687.5156 21.74550 -4.50175 26.24725 16.19358</span></span>
<span><span class="co">#&gt; 5 7.765240 8.342354 31.78373 687.5156 21.74550 -4.50175 26.24725 16.19358</span></span>
<span><span class="co">#&gt; 7 8.390240 8.568895 31.32536 722.0088 23.12525 -4.22925 27.35450 17.21496</span></span>
<span><span class="co">#&gt; 9 7.916781 8.393229 31.47658 698.7467 22.16225 -4.50275 26.66500 16.48808</span></span>
<span><span class="co">#&gt;        bio9    bio10       bio11 bio12 bio13 bio14    bio15 bio16 bio17 bio18</span></span>
<span><span class="co">#&gt; 1 0.6048333 16.19358 -0.60591668  1364   175    79 25.91408   479   270   479</span></span>
<span><span class="co">#&gt; 2 1.1871250 16.93192 -0.08562502   789    97    44 28.08648   274   136   274</span></span>
<span><span class="co">#&gt; 4 0.6048333 16.19358 -0.60591668  1364   175    79 25.91408   479   270   479</span></span>
<span><span class="co">#&gt; 5 0.6048333 16.19358 -0.60591668  1364   175    79 25.91408   479   270   479</span></span>
<span><span class="co">#&gt; 7 0.9156250 17.21496 -0.48479167  1142   143    68 23.92640   391   228   391</span></span>
<span><span class="co">#&gt; 9 0.6603751 16.48808 -0.61391664  1320   169    77 25.28074   459   264   459</span></span>
<span><span class="co">#&gt;   bio19        x        y       label            groups        EIF</span></span>
<span><span class="co">#&gt; 1   274 13.58333 47.91667 not outlier Anguilla anguilla -0.4482500</span></span>
<span><span class="co">#&gt; 2   145 10.08333 48.41667 not outlier Anguilla anguilla  0.4688750</span></span>
<span><span class="co">#&gt; 4   274 13.58333 47.91667 not outlier Anguilla anguilla -0.4482500</span></span>
<span><span class="co">#&gt; 5   274 13.58333 47.91667 not outlier Anguilla anguilla -0.4482500</span></span>
<span><span class="co">#&gt; 7   230 13.75000 48.08333 not outlier Anguilla anguilla -0.1633636</span></span>
<span><span class="co">#&gt; 9   266 13.75000 47.91667 not outlier Anguilla anguilla -0.4492954</span></span>
<span></span>
<span></span>
<span><span class="va">thymallus_qc_labelled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify_data.html">classify_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">thymallus_referencedata</span>, </span>
<span>                              outliers <span class="op">=</span> <span class="va">thymallus_outlier_detection</span>, </span>
<span>                              EIF <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">thymallus_qc_labelled</span><span class="op">)</span></span>
<span><span class="co">#&gt;       bio1      bio2     bio3     bio4     bio5     bio6     bio7     bio8</span></span>
<span><span class="co">#&gt; 1 7.765240  8.342354 31.78373 687.5156 21.74550 -4.50175 26.24725 16.19358</span></span>
<span><span class="co">#&gt; 2 8.532615  9.764146 33.03609 746.0073 23.86175 -5.69425 29.55600 17.59192</span></span>
<span><span class="co">#&gt; 3 7.782344  8.558562 33.16437 660.7922 21.44375 -4.36275 25.80650 15.84971</span></span>
<span><span class="co">#&gt; 5 8.672177 10.034145 33.87568 740.6580 24.35775 -5.26275 29.62050 17.65467</span></span>
<span><span class="co">#&gt; 6 8.091240  8.933604 32.88585 694.5287 22.77500 -4.39050 27.16550 16.61037</span></span>
<span><span class="co">#&gt; 7 7.765240  8.342354 31.78373 687.5156 21.74550 -4.50175 26.24725 16.19358</span></span>
<span><span class="co">#&gt;         bio9    bio10      bio11 bio12 bio13 bio14    bio15 bio16 bio17 bio18</span></span>
<span><span class="co">#&gt; 1  0.6048333 16.19358 -0.6059167  1364   175    79 25.91408   479   270   479</span></span>
<span><span class="co">#&gt; 2 -0.7618751 17.59192 -0.7618751   908   129    29 44.80352   372   110   372</span></span>
<span><span class="co">#&gt; 3 -0.2946250 15.84971 -0.2946250  1279   170    66 34.78019   489   215   489</span></span>
<span><span class="co">#&gt; 5  1.0584166 17.65467 -0.6058334  1261   154    52 31.64815   435   185   435</span></span>
<span><span class="co">#&gt; 6  0.8317083 16.61037 -0.4386667   808   106    42 32.08204   296   135   296</span></span>
<span><span class="co">#&gt; 7  0.6048333 16.19358 -0.6059167  1364   175    79 25.91408   479   270   479</span></span>
<span><span class="co">#&gt;   bio19        x        y       label         EIF</span></span>
<span><span class="co">#&gt; 1   274 13.58333 47.91667 not outlier  1.15569211</span></span>
<span><span class="co">#&gt; 2   110 15.25000 47.08333 not outlier -0.04936064</span></span>
<span><span class="co">#&gt; 3   215 11.58333 47.75000 not outlier  1.29615521</span></span>
<span><span class="co">#&gt; 5   188 15.08333 46.41667 not outlier  0.38668143</span></span>
<span><span class="co">#&gt; 6   138 11.75000 48.41667 not outlier  1.26811309</span></span>
<span><span class="co">#&gt; 7   274 13.58333 47.91667 not outlier  1.15569211</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualize-labeled-data-in-environmental-space-">6. Visualize labeled data in environmental space.<a class="anchor" aria-label="anchor" href="#visualize-labeled-data-in-environmental-space-"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#multiple species </span></span>
<span><span class="fu"><a href="../reference/ggenvironmentalspace.html">ggenvironmentalspace</a></span><span class="op">(</span>qcdata <span class="op">=</span> <span class="va">multiple_spp_qcdata</span>, </span>
<span>                     xvar <span class="op">=</span> <span class="st">'bio1'</span>, </span>
<span>                     yvar <span class="op">=</span> <span class="st">"bio18"</span>, </span>
<span>                     xlab <span class="op">=</span> <span class="st">"Annual mean temperature"</span>,</span>
<span>                     ylab <span class="op">=</span> <span class="st">"Precipitation of Warmest Quarter"</span>,</span>
<span>                     scalecolor <span class="op">=</span> <span class="st">'viridis'</span>,</span>
<span>                     ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                     nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                     pointsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/2d%20plots%20multiple%20species-1.png" width="720" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#for single species</span></span>
<span><span class="fu"><a href="../reference/ggenvironmentalspace.html">ggenvironmentalspace</a></span><span class="op">(</span>qcdata <span class="op">=</span> <span class="va">thymallus_qc_labelled</span>,</span>
<span>                     xvar <span class="op">=</span> <span class="st">'bio1'</span>,</span>
<span>                     yvar <span class="op">=</span> <span class="st">"bio18"</span>,</span>
<span>                     xlab <span class="op">=</span> <span class="st">"Annual mean temperature"</span>,</span>
<span>                     ylab <span class="op">=</span> <span class="st">"Precipitation of Warmest Quarter"</span>,</span>
<span>                     scalecolor <span class="op">=</span> <span class="st">'viridis'</span>,</span>
<span>                     pointsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/2d%20plots%20single%20species-1.png" width="518.4" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="using-bootstrapping-during-outlier-detection">Using bootstrapping during outlier detection<a class="anchor" aria-label="anchor" href="#using-bootstrapping-during-outlier-detection"></a>
</h3>
<p>Bootstrapping is a robust approach where the records are randomly
sampled with replacement. In this approach, outlier detection is
iteratively conducted on bootstrap samples and each record flagged as
outlier is weighted based on the total number of bootstraps used. The
higher the record is flagged in several across multiple tests, the
higher the likelihood of record being an absolute outlier. Although the
default number of records at bootstrapping is 30, the maximum number of
records can be adjusted by the user as demonstrated below.</p>
<p><strong>Note</strong></p>
<p>Bootstrapping is not implemented by the defualt, so the user has to
set it run during outlier detection.</p>
<ul>
<li><p>The number of records <strong>maxrecords</strong> in reference
dataset for <em>Thymallus thymallus</em> is 99. Therefore, to implement
bootstrapping, indicate the maximum number of records higher than the
nrows in reference dataset otherwise bootstrap will not be
implemented.</p></li>
<li><p>The number of bootstraps, <strong>nb</strong> are
user-defined.</p></li>
<li><p>Bootstrapping was conducted on <em>Thymallus thymallus</em> data
because there was no proper separation between the moderate and very
strong outliers.</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">thymallus_outlier_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidetect.html">multidetect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thymallus_referencedata</span>,</span>
<span>                      multiple <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      var <span class="op">=</span> <span class="st">'bio6'</span>,</span>
<span>                      exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>,<span class="st">'y'</span><span class="op">)</span>,</span>
<span>                      methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'zscore'</span>, <span class="st">'adjbox'</span>,</span>
<span>                                  <span class="st">'logboxplot'</span>, <span class="st">'distboxplot'</span>,</span>
<span>                                  <span class="st">'iqr'</span>, <span class="st">'semiqr'</span>,</span>
<span>                                  <span class="st">'hampel'</span>,<span class="st">'kmeans'</span>,</span>
<span>                                  <span class="st">'jknife'</span>, <span class="st">'onesvm'</span>,</span>
<span>                                  <span class="st">'iforest'</span><span class="op">)</span>,</span>
<span>                      bootSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>run <span class="op">=</span> <span class="cn">TRUE</span>, maxrecords <span class="op">=</span> <span class="fl">100</span>, nb <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visulise-outliers-after-bootstrapping">Visulise outliers after bootstrapping<a class="anchor" aria-label="anchor" href="#visulise-outliers-after-bootstrapping"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/ggoutliers.html">ggoutliers</a></span><span class="op">(</span><span class="va">thymallus_outlier_boot</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/visualisationboot-1.png" width="2160" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="classify-data-to-obtain-labels">Classify data to obtain labels<a class="anchor" aria-label="anchor" href="#classify-data-to-obtain-labels"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">thymallus_qc_label_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify_data.html">classify_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">thymallus_referencedata</span>, </span>
<span>                                outliers <span class="op">=</span> <span class="va">thymallus_outlier_boot</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualise-after-bootstrapping">Visualise after bootstrapping<a class="anchor" aria-label="anchor" href="#visualise-after-bootstrapping"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/ggenvironmentalspace.html">ggenvironmentalspace</a></span><span class="op">(</span>qcdata <span class="op">=</span> <span class="va">thymallus_qc_label_boot</span>, </span>
<span>                     xvar <span class="op">=</span> <span class="st">'bio1'</span>, </span>
<span>                     yvar <span class="op">=</span> <span class="st">"bio18"</span>,</span>
<span>                     xlab <span class="op">=</span> <span class="st">"Annual mean temperature"</span>,</span>
<span>                     ylab <span class="op">=</span> <span class="st">"Precipitation of Warmest Quarter"</span>,</span>
<span>                     scalecolor <span class="op">=</span> <span class="st">'viridis'</span>,</span>
<span>                     pointsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/ggspaceboot-1.png" width="2400" style="display: block; margin: auto;"></p>
<p><strong>Note</strong></p>
<p>When bootstrapping is applied, the very strong outlier turned into
moderate outlier.</p>
</div>
<div class="section level3">
<h3 id="apply-principal-component-analysis-and-bootstrapping-on-thymallus-thymallus-data-">Apply principal component analysis and bootstrapping on
<em>Thymallus thymallus</em> data.<a class="anchor" aria-label="anchor" href="#apply-principal-component-analysis-and-bootstrapping-on-thymallus-thymallus-data-"></a>
</h3>
<ul>
<li><p>Principal component analyis is a dimension reduction approach
vital for highly multidimensional datasets. The user can decide to apply
either PCA and bootstrapping or only one of them.</p></li>
<li><p>The number of principal components to be returned are changed
using <strong>npc</strong> argument.</p></li>
<li><p>The visualise the cummulation variance captured in the principal
components, the argument <strong>q</strong> is used.</p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">thymallus_outlier_boot_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multidetect.html">multidetect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thymallus_referencedata</span>,</span>
<span>                      multiple <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      var <span class="op">=</span> <span class="st">'bio6'</span>,</span>
<span>                      exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x'</span>,<span class="st">'y'</span><span class="op">)</span>,</span>
<span>                      methods <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'zscore'</span>, <span class="st">'adjbox'</span>,</span>
<span>                                  <span class="st">'logboxplot'</span>, <span class="st">'distboxplot'</span>,</span>
<span>                                  <span class="st">'iqr'</span>, <span class="st">'semiqr'</span>,</span>
<span>                                  <span class="st">'hampel'</span>,<span class="st">'kmeans'</span>,</span>
<span>                                  <span class="st">'jknife'</span>, <span class="st">'onesvm'</span>,</span>
<span>                                  <span class="st">'iforest'</span><span class="op">)</span>,</span>
<span>                      bootSettings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>run <span class="op">=</span> <span class="cn">TRUE</span>, maxrecords <span class="op">=</span> <span class="fl">100</span>, nb <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>                      pc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>exec <span class="op">=</span> <span class="cn">TRUE</span>, npc <span class="op">=</span> <span class="fl">6</span>, q <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; The cummulative proprotion for PCs 6 is 0.99265</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visulise-outliers-after-bootstrapping-and-bootstrapping">Visulise outliers after bootstrapping and bootstrapping<a class="anchor" aria-label="anchor" href="#visulise-outliers-after-bootstrapping-and-bootstrapping"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/ggoutliers.html">ggoutliers</a></span><span class="op">(</span><span class="va">thymallus_outlier_boot_pca</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/visualisationbootpca-1.png" width="2160" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="classify-data-to-obtain-labels-1">Classify data to obtain labels<a class="anchor" aria-label="anchor" href="#classify-data-to-obtain-labels-1"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">thymallus_qc_label_boot_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/classify_data.html">classify_data</a></span><span class="op">(</span>refdata <span class="op">=</span> <span class="va">thymallus_referencedata</span>, </span>
<span>                                outliers <span class="op">=</span> <span class="va">thymallus_outlier_boot_pca</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualise-after-bootstrapping-1">Visualise after bootstrapping<a class="anchor" aria-label="anchor" href="#visualise-after-bootstrapping-1"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/ggenvironmentalspace.html">ggenvironmentalspace</a></span><span class="op">(</span>qcdata <span class="op">=</span> <span class="va">thymallus_qc_label_boot_pca</span>, </span>
<span>                     xvar <span class="op">=</span> <span class="st">'bio1'</span>, </span>
<span>                     yvar <span class="op">=</span> <span class="st">"bio18"</span>,</span>
<span>                     xlab <span class="op">=</span> <span class="st">"Annual mean temperature"</span>,</span>
<span>                     ylab <span class="op">=</span> <span class="st">"Precipitation of Warmest Quarter"</span>,</span>
<span>                     scalecolor <span class="op">=</span> <span class="st">'viridis'</span>,</span>
<span>                     pointsize <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="eOutlier_files/figure-html/ggspacebootpca-1.png" width="2400" style="display: block; margin: auto;"></p>
<p><strong>Notes</strong></p>
<p>Coupling PCA and bootstrapping are robust approaches to handle
outlier detection. In this example, moderate outlier turned into poor
outliers.</p>
<p><strong>References</strong></p>
<ol style="list-style-type: decimal">
<li>Wieczorek, J., Bloom, D., Guralnick, R., Blum, S., DÃ¶ring, M.,
Giovanni, R., Robertson, T., &amp; Vieglais, D. (2012). Darwin core: An
evolving community-developed biodiversity data standard. PLoS ONE, 7(1).
<a href="https://doi.org/10.1371/journal.pone.0029715" class="external-link uri">https://doi.org/10.1371/journal.pone.0029715</a>
</li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anthony Basooma, Thomas Hein, Astrid Schmidt-Kloiber, Florian Borgwardt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
